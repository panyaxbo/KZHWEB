<script src="accounting.min.js"></script>

<template>
    <style>
      :host {
        display: block;
      }
    </style>
    <span></span>
</template>

<script>
(function() {

    // Grab our template full of slider markup and styles
    var currentScript = document._currentScript || document.currentScript;
    var owner = currentScript.ownerDocument;
    var tmpl = owner.querySelector('template');
    // Creates an object based in the HTML Element prototype
    var element = Object.create(HTMLElement.prototype);

    // Fires when an instance of the element is created
    element.createdCallback = function() {

        var root = this.createShadowRoot();
        root.appendChild(document.importNode(tmpl.content, true));

        var type = (this.getAttribute("type")) ? this.getAttribute("type") : "number";
        var symbol = (this.getAttribute("symbol")) ? this.getAttribute("symbol") : "$";
        var format = (this.getAttribute("format")) ? this.getAttribute("format") : "%s%v";
        var decimal = (this.getAttribute("decimal")) ? this.getAttribute("decimal") : ".";
        var thousand = (this.getAttribute("thousand")) ? this.getAttribute("thousand") : ",";
        var precision = (this.getAttribute("precision")) ? this.getAttribute("precision") : 0;

        var ctx = (this.textContent) ? this.textContent : 0;

        accounting.settings = {
            currency: {
                symbol : symbol,
                format: format,
                decimal : decimal,
                thousand: thousand,
                precision : precision
            },
            number: {
                precision : precision,
                thousand: thousand,
                decimal : decimal
            }
        }

        switch (type) {
            case "money":
                root.querySelector("span").textContent = accounting.formatMoney(ctx);
                break;
            case "column":
                root.querySelector("span").textContent = accounting.formatColumn(ctx.toString().split(","), symbol, precision, thousand, decimal, format);
                break;
            case "number":
                root.querySelector("span").textContent = accounting.formatNumber(ctx);
                break;
            case "tofixed":
                root.querySelector("span").textContent = accounting.toFixed(ctx, precision);
                break;
            case "unformat":
                root.querySelector("span").textContent = accounting.unformat(ctx, decimal);
                break;
        }

    };

    // Fires when an instance was inserted into the document
    // element.attachedCallback = function() {};

    // Fires when an instance was removed from the document
    // element.detachedCallback = function() {};

    // Fires when an attribute was added, removed, or updated
    // element.attributeChangedCallback = function(attr, oldVal, newVal) {};

    document.registerElement('number-format', {
        prototype: element
    });
}());
</script>
